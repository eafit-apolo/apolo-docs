

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Monitoring Architecture &mdash; apolo-docs 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/sidebar.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Nagios" href="../nagios/index.html" />
    <link rel="prev" title="Monitoring" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

  
    <a href="../../../index.html">
  

  
    
    <img src="../../../_static/apolo-white.png" style="width: 150px;" class="logo" alt="Logo"/>
  
    </a>

    
      
      
      
	<div class="version" style="color: rgba(255,255,255,0.5);">
	  0.1
	</div>
      
    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../supercomputers/index.html">Supercomputers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../virtualization/index.html">Virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programminglanguages/index.html">Programming Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../applications/index.html">Scientific Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resourcemanager/index.html">Resource Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Monitoring</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Monitoring Architecture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-information">Basic information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sensu-graphite-grafana">Sensu-Graphite-Grafana</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authors">Authors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nagios/index.html">Nagios</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sensu/index.html">Sensu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elk/index.html">ELK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../grafana/index.html">Grafana</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../operatingsystems/index.html">Operating Systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../how-to-acknowledge.html">How to Acknowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../report-a-bug.html">Report a Bug</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">apolo-docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Software</a> &raquo;</li>
        
          <li><a href="../index.html">Monitoring</a> &raquo;</li>
        
      <li>Monitoring Architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/software/monitoring/architecture/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="monitoring-architecture">
<span id="monitoring-architecture-index"></span><h1><a class="toc-backref" href="#id11">Monitoring Architecture</a><a class="headerlink" href="#monitoring-architecture" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#monitoring-architecture" id="id11">Monitoring Architecture</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-information" id="id12">Basic information</a></p></li>
<li><p><a class="reference internal" href="#sensu-graphite-grafana" id="id13">Sensu-Graphite-Grafana</a></p>
<ul>
<li><p><a class="reference internal" href="#components" id="id14">Components</a></p></li>
<li><p><a class="reference internal" href="#workflow" id="id15">WorkFlow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#authors" id="id16">Authors</a></p></li>
<li><p><a class="reference internal" href="#references" id="id17">References</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="basic-information">
<h2><a class="toc-backref" href="#id12">Basic information</a><a class="headerlink" href="#basic-information" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Deploy date:</strong> 29th July, 2019</p></li>
</ul>
</div>
<div class="section" id="sensu-graphite-grafana">
<h2><a class="toc-backref" href="#id13">Sensu-Graphite-Grafana</a><a class="headerlink" href="#sensu-graphite-grafana" title="Permalink to this headline">¶</a></h2>
<div class="section" id="components">
<h3><a class="toc-backref" href="#id14">Components</a><a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h3>
<p><strong>Monitoring Core:</strong> Provides a scalable event processing platform for processing check results and
monitoring events. <a class="footnote-reference brackets" href="#id7" id="id1">1</a></p>
<ul class="simple">
<li><p><strong>Sensu Server:</strong> Schedules and publishes check execution requests to client subscriptions. <a class="footnote-reference brackets" href="#id7" id="id2">1</a></p></li>
<li><p><strong>Sensu API:</strong> Provides access to monitoring data collected by Sensu through a RESTful API endpoint.</p></li>
<li><p><strong>Redis:</strong> In-memory Key-value data structure store, used by Sensu to store monitoring data.</p></li>
</ul>
<p><strong>Sensu Clients:</strong> This layer is composed of the agents that need to be monitored.</p>
<p><strong>Communication:</strong> Sensu Services use a message bus for communication, sensu check requests and check results
are published as messages to this layer, and the corresponding sensu services receive these messages by
subscribing to the appropriate subscriptions <a class="footnote-reference brackets" href="#id8" id="id3">2</a>.</p>
<blockquote>
<div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using Redis as a transport greatly simplifies Sensu’s architecture, however, Redis transport is NOT
recommended for production environments. <a class="footnote-reference brackets" href="#id9" id="id4">3</a></p>
</div>
</div></blockquote>
<ul class="simple">
<li><p><strong>RabbitMQ:</strong> Message Broker that communicates Sensu Clients with the Server.</p></li>
</ul>
<p><strong>Store Time-series data:</strong> Sensu doesn’t store time-series natively, it’s necessary to
integrate it with Graphite to have historic registers of the results.</p>
<p>Carbon refers to various daemons that make up the storage backend of a Graphite installation <a class="footnote-reference brackets" href="#id10" id="id5">4</a>.
This architecture only needs to use Carbon Cache, but later, Carbon Relay and Carbon aggregator can
be added without problems.</p>
<ul class="simple">
<li><p><strong>Carbon Cache:</strong> listens for metrics and writes them to disk as efficiently
as possible. This requires caching metric values in RAM as they are received and flushing them to
disk on an interval using the underlying whisper library. It also provides a query service for
in-memory metric datapoints, used by the Graphite web app to retrieve “hot data”. <a class="footnote-reference brackets" href="#id10" id="id6">4</a></p></li>
<li><p><strong>Graphite Web:</strong> Graphite’s user interface and RESTful API endpoint.</p></li>
<li><p><strong>Whisper:</strong> Fixed-size database, similar in design and purpose to RRD (round-robin-database).
Whisper allows for higher resolution (seconds per point) of recent data to degrade into lower
resolutions for long-term retention of historical data.</p></li>
</ul>
<p><strong>Visualization:</strong> Displays the configuration, current state and monitoring results.</p>
<ul class="simple">
<li><p><strong>Uchiwa:</strong> Web Dashboard for visualizing Sensu status and Configuration.</p></li>
<li><p><strong>Grafana:</strong> Shows time-series and monitoring results in dashboards and manage email alerts
with established thresholds.</p></li>
</ul>
</div>
<div class="section" id="workflow">
<h3><a class="toc-backref" href="#id15">WorkFlow</a><a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="../../../_images/monitoring-architecture.png"><img alt="Monitoring Architecture" class="align-center" src="../../../_images/monitoring-architecture.png" style="width: 705.6px; height: 412.2px;" /></a>
<ol class="arabic simple">
<li><p>Sensu Server schedules the checks, posting pending checks in RabbitMQ for each subscription.</p></li>
<li><p>Each Sensu Client ask for the checks related to its subscriptions in RabbitMQ</p></li>
<li><p>After executing the Check, the clients post the results in RabbitMQ</p></li>
<li><p>Sensu Server processes the results and executes the respective handlers and mutators if necessary.</p></li>
<li><p>The last results are stored in Redis, registering ONLY the current state of the checks.</p></li>
<li><p>Sensu API provides that current state (configuration and events) to Grafana and Uchiwa.</p></li>
<li><p>If the check is configured, Sensu can report a bad execution or an unexpected situation sending
an email.</p></li>
<li><p>The checks that have to be stored as TimeSeries pass their results to Carbon Cache.</p></li>
<li><p>Carbon Cache stores the results until the buffer is full, in this case, it flushes the
results calling the Whisper Library and storing it as efficiently as possible.</p></li>
<li><p>Graphite Web provides this stored information through its API Rest endpoint.</p></li>
<li><p>Grafana takes the results stored in Graphite and creates the desired dashboard.</p></li>
<li><p>If a threshold is established and an alarm configured in Grafana, it can report an anomaly
sending an email.</p></li>
</ol>
</div>
</div>
<div class="section" id="authors">
<h2><a class="toc-backref" href="#id16">Authors</a><a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Andrés Felipe Zapata Palacio &lt;<a class="reference external" href="mailto:azapat47&#37;&#52;&#48;eafit&#46;edu&#46;co">azapat47<span>&#64;</span>eafit<span>&#46;</span>edu<span>&#46;</span>co</a>&gt;</p></li>
</ul>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id17">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>Sensu Server: Sensu Core 1.5. (n.d.). Retrieved July 30, 2019,
from <a class="reference external" href="https://docs.sensu.io/sensu-core/1.5/reference/server/">https://docs.sensu.io/sensu-core/1.5/reference/server/</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Transport: Sensu Core 1.5. (n.d.). Retrieved July 30, 2019,
from <a class="reference external" href="https://docs.sensu.io/sensu-core/1.5/reference/transport/">https://docs.sensu.io/sensu-core/1.5/reference/transport/</a></p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Redis Configuration: Sensu Core 1.5. (n.d.). Retrieved July 30, 2019,
from <a class="reference external" href="https://docs.sensu.io/sensu-core/1.5/reference/redis/#how-does-sensu-use-redis">https://docs.sensu.io/sensu-core/1.5/reference/redis/#how-does-sensu-use-redis</a></p>
</dd>
<dt class="label" id="id10"><span class="brackets">4</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>The Carbon Daemons. (n.d.). Retrieved July 30, 2019,
from <a class="reference external" href="https://graphite.readthedocs.io/en/latest/carbon-daemons.html">https://graphite.readthedocs.io/en/latest/carbon-daemons.html</a></p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../nagios/index.html" class="btn btn-neutral float-right" title="Nagios" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Monitoring" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Creative Commons Attribution-NonCommercial 4.0 International License

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>